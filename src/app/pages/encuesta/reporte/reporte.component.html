<section class="section mt-2">
  <div class="card">
    <div class="card-body align-items-center">
      <form [formGroup]="seachForm">
        <div class="form-row">
          <div class="col-md-3">
            <div class="position-relative form-group">
              <label for="exampleEmail11" class="">Seleccionar por fechas/periodo</label>
              <select class="form-control form-control-sm" formControlName="opselect" (change)="onChange($event)">
                <option value="">Seleccionar</option>
                <option value="1" selected>Periodo</option>
                <option value="2">Rango de fechas</option>
              </select>
            </div>
          </div>
          <div class="col-md-3" *ngIf="isPeriodo">
            <div class="position-relative form-group">
              <label class="">Periodo</label>
              <input class="form-control form-control-sm" [(ngModel)]="ngperiodo" formControlName="periodo"
                type="month" />
            </div>
          </div>
          <div class="col-md-4" *ngIf="isRangoFecha">
            <div class="row">
              <div class="col-md-6">
                <div class="position-relative form-group">
                  <label class="">Fecha Inicio</label>
                  <input name="password" type="date" formControlName="fecha_inicio"
                    class="form-control form-control-sm" />
                </div>
              </div>
              <div class="col-md-6">
                <div class="position-relative form-group">
                  <label class="">Fecha Final</label>
                  <input name="password" type="date" formControlName="fecha_fin" class="form-control form-control-sm" />
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="position-relative form-group">
              <label for="exampleEmail11" class="">Sede</label>
              <select class="form-control form-control-sm" formControlName="sede">
                <option value="0">Todos las sedes</option>
                <option value="1">Lima</option>
                <option value="2">Chorrillos</option>
                <option value="4">Surco</option>
              </select>
            </div>
          </div>
          <div class="col-md-2">
            <div class="input-group">
              <div class="input-group-btn pt-4">
                <button (click)="search()" class="mb-2 mr-2 btn btn-primary btn-sm float-right">
                  <i class="pe-7s-search"> </i>Procesar
                </button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>

  <div class="row">
    <div class="col-xl-3 col-lg-6 col-md-6 col-sm-6 col-xs-12">
      <div class="card">
        <div class="card-statistic-4">
          <div class="align-items-center justify-content-between">
            <div class="row">
              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pr-0 pt-3">
                <div class="card-content">
                  <h5 class="font-15">REGISTRO TOTAL DE ENCUESTA</h5>
                  <h2 class="mb-3 font-18">
                    {{ this.listencuesta }}
                  </h2>
                  <!--p class="mb-0">
                        <span class="col-green">10%</span> Increase
                      </p-->
                </div>
              </div>
              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pl-0">
                <div class="banner-img">
                  <img src="assets/images/banner/reclamos_registrados.png" width="84" alt="" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


    <div class="col-xl-3 col-lg-6 col-md-6 col-sm-6 col-xs-12">
      <div class="card">
        <div class="card-statistic-4">
          <div class="align-items-center justify-content-between">
            <div class="row">
              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pr-0 pt-3">
                <div class="card-content">
                  <h5 class="font-15">REGISTRO TOTAL DE LIMA</h5>
                  <h2 class="mb-3 font-18">
                    {{ this.listlima.length }}
                  </h2>
                  <!--p class="mb-0">
                      <span class="col-orange">09%</span> Decrease
                    </p-->
                </div>
              </div>
              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pl-0">
                <div class="banner-img">
                  <img src="assets/images/banner/reclamos_resueltos.png" width="84" alt="" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-lg-6 col-md-6 col-sm-6 col-xs-12">
      <div class="card">
        <div class="card-statistic-4">
          <div class="align-items-center justify-content-between">
            <div class="row">
              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pr-0 pt-3">
                <div class="card-content">
                  <h5 class="font-15">REGISTRO TOTAL DE CHORRILLOS</h5>
                  <h2 class="mb-3 font-18">
                    {{ this.listchorrillos.length }}
                  </h2>
                  <!--p class="mb-0">
                      <span class="col-green">18%</span> Increase
                    </p-->
                </div>
              </div>
              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pl-0">
                <div class="banner-img">
                  <img src="assets/images/banner/reclamos_pendiente.png" width="84" alt="" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-lg-6 col-md-6 col-sm-6 col-xs-12">
      <div class="card">
        <div class="card-statistic-4">
          <div class="align-items-center justify-content-between">
            <div class="row">
              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pr-0 pt-3">
                <div class="card-content">
                  <h5 class="font-15">REGISTRO TOTAL DE SURCO</h5>
                  <h2 class="mb-3 font-18">
                    {{ this.listsurco.length }}
                  </h2>
                  <!--p class="mb-0">
                      <span class="col-green">18%</span> Increase
                    </p-->
                </div>
              </div>
              <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pl-0">
                <div class="banner-img">
                  <img src="assets/images/banner/otros.png" width="84" alt="" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="row">
    <div class="col-md-6 col-lg-12 col-xl-6">
      <!-- Support tickets -->
      <div class="card mt-sm-5 mt-md-0">
        <div class="card-header">
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-8">
                <h5>Total de registros por sede</h5>
              </div>
              <div class="col-md-4">
                <button type="button" (click)="showTableDasboard(1, 2)" class="btn-shadow btn btn-info float-right">
                  <i class="pe-7s-graph3"></i>
                </button>
                <button type="button" (click)="showTableDasboard(1, 1)"
                  class="btn-shadow mr-3 btn btn-info float-right">
                  <i class="pe-7s-graph"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body" *ngIf="isPosition1">
          <loading *ngIf="isLoading2">{{ isLoading }}</loading>
          <div class="d-block" *ngIf="!isLoading2">
            <canvas baseChart [datasets]="barChartData" [labels]="barChartLabels" [options]="barChartOptions"
              [plugins]="barChartPlugins" [legend]="barChartLegend" [chartType]="barChartType">
            </canvas>
          </div>
        </div>
        <div class="card-body" *ngIf="!isPosition1">
          <div class="table-responsive p-4">
            <table class="
                  align-middle
                  text-truncate
                  mb-0
                  table table-sm table-borderless table-hover
                ">
              <thead>
                <tr>
                  <th class="text-left">Sede</th>
                  <th class="text-left">Total</th>
                  <th class="text-left">Porcentaje</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left">Lima</td>
                  <td>{{ this.listlima.length }}</td>
                  <td>{{ getporcentaje(this.listlima.length) }}</td>
                </tr>
                <tr>
                  <td class="text-left">Chorrillos</td>
                  <td>{{ this.listchorrillos.length }}</td>
                  <td>{{getporcentaje(this.listchorrillos.length) }}</td>
                </tr>
                <tr>
                  <td class="text-left">Surco</td>
                  <td class="text-left">{{ this.listsurco.length }}</td>
                  <td class="text-left">{{ getporcentaje(this.listsurco.length)}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>    
    </div>
    <div class="col-md-6 col-lg-12 col-xl-6">
      <div class="card">
        <div class="card-header">
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-8">
                <h4>Total de encuestados por Modalidad</h4>
              </div>
              <div class="col-md-4">
                <button type="button" (click)="showTableDasboard(2, 2)" class="btn-shadow btn btn-info float-right">
                  <i class="pe-7s-graph3"></i>
                </button>
                <button type="button" (click)="showTableDasboard(2, 1)"
                  class="btn-shadow mr-3 btn btn-info float-right">
                  <i class="pe-7s-graph"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body" *ngIf="isPosition2">
          <loading *ngIf="isLoading2">{{ isLoading }}</loading>
          <div class="chart" *ngIf="!isLoading">
            <canvas baseChart [data]="pieChartData" [labels]="pieChartLabels" [chartType]="pieChartType"
              [options]="pieChartOptions" [plugins]="pieChartPlugins" [colors]="pieChartColors"
              [legend]="pieChartLegend">
            </canvas>
          </div>
        </div>
        <div class="card-body" *ngIf="!isPosition2">
          <div class="table-responsive p-4">
            <table class="
                  align-middle
                  text-truncate
                  mb-0
                  table table-sm table-borderless table-hover
                ">
              <thead>
                <tr>
                  <th class="text-left">Modalidad</th>
                  <th class="text-left">Total</th>
                  <th class="text-left">Porcentaje</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left">Hospitalización</td>
                  <td>{{ this.listhospita.length }}</td>
                  <td>{{ getporcentaje(this.listhospita.length) }}</td>
                </tr>
                <tr>
                  <td class="text-left">Consultorio</td>
                  <td>{{ this.listconsultorio.length }}</td>
                  <td>{{getporcentaje(this.listconsultorio.length) }}</td>
                </tr>
                <tr>
                  <td class="text-left">Emergencia</td>
                  <td class="text-left">{{ this.listemergencia.length }}</td>
                  <td class="text-left">{{ getporcentaje( this.listemergencia.length)}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-6 col-lg-12 col-xl-6">

      <div class="card mt-sm-5 mt-md-0">
        <div class="card-header">
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-8">
                <h4>Reclamos Resueltos</h4>
              </div>
              <div class="col-md-4">
                <button type="button" (click)="showTableDasboard(3, 2)" class="btn-shadow btn btn-info float-right">
                  <i class="pe-7s-graph3"></i>
                </button>
                <button type="button" (click)="showTableDasboard(3, 1)"
                  class="btn-shadow mr-3 btn btn-info float-right">
                  <i class="pe-7s-graph"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body" *ngIf="isPosition3">
          <loading *ngIf="isLoading3">{{ isLoading }}</loading>
          <div class="chart" *ngIf="!isLoading3">
            <canvas baseChart [data]="pieChartData2" [labels]="pieChartLabels2" [chartType]="pieChartType2"
              [options]="pieChartOptions2" [plugins]="pieChartPlugins2" [colors]="pieChartColors2"
              [legend]="pieChartLegend2">
            </canvas>
          </div>
        </div>
        <div class="card-body" *ngIf="!isPosition3">
          <div class="table-responsive p-4">
            <table class="
                  align-middle
                  text-truncate
                  mb-0
                  table table-sm table-borderless table-hover
                ">
              <thead>
                <tr>
                  <th class="text-left">Tipo de Usuario</th>
                  <th class="text-left">Total</th>
                  <th class="text-left">Porcentaje</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left">Plan Salud</td>
                  <td>{{ this.plansalud.length }}</td>
                  <td>{{ getporcentaje(this.plansalud.length) }}</td>
                </tr>
                <tr>
                  <td class="text-left">Institucional</td>
                  <td>{{ this.institucional.length }}</td>
                  <td>{{getporcentaje(this.institucional.length) }}</td>
                </tr>
                <tr>
                  <td class="text-left">Convenio</td>
                  <td class="text-left">{{ this.convenio.length }}</td>
                  <td class="text-left">{{ getporcentaje(this.convenio.length)}}</td>
                </tr>
                <tr>
                  <td class="text-left">Compañia Seguro</td>
                  <td class="text-left">{{ this.compania.length }}</td>
                  <td class="text-left">{{ getporcentaje(this.compania.length)}}</td>
                </tr>
                <tr>
                  <td class="text-left">Madre Niño</td>
                  <td class="text-left">{{ this.madrenino.length }}</td>
                  <td class="text-left">{{ getporcentaje(this.madrenino.length)}}</td>
                </tr>
                <tr>
                  <td class="text-left">Otros</td>
                  <td class="text-left">{{ this.otross.length }}</td>
                  <td class="text-left">{{ getporcentaje(this.otross.length)}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
    <div class="col-md-6 col-lg-12 col-xl-6">
      <div class="card">
        <div class="card-header">
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-8">
                <h4>Reclamos por Estado</h4>
              </div>
              <div class="col-md-4">
                <button type="button" (click)="showTableDasboard(4, 2)" class="btn-shadow btn btn-info float-right">
                  <i class="pe-7s-graph3"></i>
                </button>
                <button type="button" (click)="showTableDasboard(4, 1)"
                  class="btn-shadow mr-3 btn btn-info float-right">
                  <i class="pe-7s-graph"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body" *ngIf="isPosition4">
          <loading *ngIf="isLoading4">{{ isLoading }}</loading>
          <div class="chart" *ngIf="!isLoading4">
            <canvas baseChart [data]="pieChartData3" [labels]="pieChartLabels3" [chartType]="pieChartType3"
              [options]="pieChartOptions3" [plugins]="pieChartPlugins3" [colors]="pieChartColors3"
              [legend]="pieChartLegend3">
            </canvas>
          </div>
        </div>
        <div class="card-body" *ngIf="!isPosition4">
          <div class="table-responsive p-4">
            <table class="
                  align-middle
                  text-truncate
                  mb-0
                  table table-sm table-borderless table-hover
                ">
              <thead>
                <tr>
                  <th class="text-left">Nombres</th>
                  <th class="text-left">Cantidad</th>
                  <th class="text-left">Porcentaje</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of liststate">
                  <td class="text-left">{{ item.nombre }}</td>
                  <td class="text-left">{{ item.total }}</td>
                  <td class="text-left">{{ getPorcentaje(item.total) }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

</section>