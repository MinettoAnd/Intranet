<div class="app-content content">
    <div class="content-wrapper">
      <div class="content-header row mb-1">
        <app-breadcrumb class="col-12" [breadcrumb]="breadcrumb"></app-breadcrumb>
      </div>
      <div class="content-body">
        <section id="selection-n-deletion">
          <div class="row">
  
            <div class="col-12">
              <form [formGroup]="filtroForm">
                <div class="row" style="margin-bottom: -0.5rem;">
                  <div class="form-group col-sm-12">
                    <div class="input-group input-group-sm fecha">
                      <div class="input-group-prepend">
                      <span class="input-group-text">Año</span>
                      </div>
                      <select formControlName="anio" class="form-control form-select" (change)="onAnioChange($event.target.value)">
                      <option
                          *ngFor="let option of optionsAnio"
                          [value]="option.value"
                      >
                          {{ option.label }}
                      </option>
                    </select>
                  </div>
                    <div class="input-group input-group-sm fecha">
                      <div class="input-group-prepend">
                      <span class="input-group-text">Mes</span>
                      </div>
                      <select formControlName="mes" class="form-control form-select" (change)="onMesChange($event.target.value)">
                      <option
                          *ngFor="let option of optionsMes"
                          [value]="option.value"
                      >
                          {{ option.label }}
                      </option>
                  </select>
                  </div>
                    <div class="input-group-btn">
                    <button (click)="filter()" class="btn btn-sm btn-primary">
                        <i class="fa fa-search"></i> Filtrar
                    </button>
                    </div>
                  </div>
                </div>
              </form>
              <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs" style="justify-content: end;">
                <li [ngbNavItem]="1">
                    <a ngbNavLink>PAGADO EN PERIODO</a>
                      <ng-template ngbNavContent>
                        
                        <div class="card " *ngIf="action">
                          <div class="card-header">
                            <h5 class="card-title" style="bottom:13px;">PAGOS DE PLANILLA REALIZADOS EN PERIODO {{periodo}}</h5>
                            <!-- <p>{{message}}</p> -->
                            
                          </div>
                          <div class="card-content collapse show">
                            <div class="card-body">
                              <div class="table table-striped table-bordered selection-deletion-row">
                                <div class="box box-solid">    
                                  <div id="accordion1">
                                    <div class="row">
                                      <div class="card col-md-6">
                                        <div class="card-header-info" >
                                          <div class="box-header">
                                            <div class="toggle-table">
                                              <div class="callout callout-info">
                                                <h3 class="box-title">PAGOS REALIZADOS EN PERIODO SELECCIONADO EN SOLES</h3>
                                              </div>
                                              <button type="button" class="btn btn-outline-primary" (click)="collapse1.toggle()" [attr.aria-expanded]="!isCollapsed1"
                                              aria-controls="collapseExample">
                                              <i class="fa fa-minus" *ngIf="!isCollapsed1"> </i>
                                              <i class="fa fa-plus" *ngIf="isCollapsed1"> </i> 
                                              </button>
                                            </div>
                                          </div>
                                        </div>
                                        <div #collapse1="ngbCollapse" [(ngbCollapse)]="isCollapsed1">
                                          <div>
                                            <div class="row" style="align-items: center;justify-content: space-between;">
                                              <ul class="list-group list-group-horizontal list-group-flush">
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(1)">
                                                    <i class="fa fa-external-link"></i>
                                                    Copiar tabla
                                                  </button>
                                                </li>
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(1)">
                                                    <i class="fa fa-external-link"></i>
                                                    Exportar tabla a Excel
                                                  </button>
                                                </li>
                                              </ul>
                                            </div>
                                            <ngx-datatable #myTable1
                                            class="bootstrap table table-striped"
                                            id="datatablele"
                                              [columns]="columns1"
                                              [rows]="rows1"
                                              [columnMode]="ColumnMode.force"
                                              [headerHeight]="$any('auto')"
                                              [rowHeight]="$any('auto')"
                                              [scrollbarH]="true"
                                              [summaryRow]="enableSummary"
                                              [summaryPosition]="summaryPosition"
                                              [summaryHeight]="35"
                                              [selected]="selected"
                                              [selectionType]="SelectionType.single"
                                              (select)='open($event)'
                                              >
                                              <ngx-datatable-column [sorteable] = false [headerClass]="column.headerClass" [cellClass]="column.cellClass" [summaryFunc]="column.prop == 'PeriodoTXT' ? summaryNull:summaryForAmount" [flexGrow]="1" [minWidth]="10" [width]="column.width" *ngFor="let column of columns1; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                                                <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                                  let-row="row">
                                                  <!-- <span *ngIf="column.prop == 'PeriodoTXT'">{{value}}</span>
                                                  <span *ngIf="column.prop !== 'PeriodoTXT'">{{value  | currency }}</span> -->
                                                    <span *ngIf="column.prop == 'PeriodoTXT' ">{{value}}</span>
                                                    <span *ngIf="column.prop == 'Total'">{{value | currency}}</span>
                                                    <span *ngIf="value > 0 && column.prop !== 'PeriodoTXT' && column.prop !== 'Total'" [title]="value">
                                                      <a href="javascript:;" (click)="open($event, column.prop,'PAGADO','',content)" style="color: #4B9FDE;">{{value | currency }}</a>
                                                    </span>
                                                    <span *ngIf="value == 0 && column.prop !== 'PeriodoTXT'">{{value  | currency }}</span>
                                                </ng-template>
                                              </ngx-datatable-column>
                                            </ngx-datatable>
                                          </div>
                                          <div class="ml-3">
                                            <b><p><span id="p_banco" style="border-bottom: 1px solid #000000; padding-bottom: 3px;"> &nbsp; Pago Corriente de Planilla (Periodo {{periodo_emp}}) : &nbsp; </span></p></b>
                                            <p style="margin-left: 25px;" id="p_bcp">Banco BCP : S/ &nbsp; {{banco_bcp_m | currency }} &nbsp; &nbsp; ( {{banco_bcp_f}} )</p>
                                            <p style="margin-left: 25px;" id="p_continental">Banco Continental : &nbsp; S/ {{banco_con_m | currency}} &nbsp; &nbsp; ( {{banco_con_f}} )</p>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="card col-md-6">
                                        <div class="card-header-info" >
                                          <div class="box-header">
                                            <div class="toggle-table">
                                              <div class="callout callout-info">
                                                <h3 class="box-title">PAGOS REALIZADOS EN PERIODO SELECCIONADO EN NRO. DE COLABORADORES</h3>
                                              </div>
                                              <button type="button" class="btn btn-outline-primary" (click)="collapse2.toggle()" [attr.aria-expanded]="!isCollapsed2"
                                              aria-controls="collapseExample">
                                              <i class="fa fa-minus" *ngIf="!isCollapsed2"> </i>
                                              <i class="fa fa-plus" *ngIf="isCollapsed2"> </i> 
                                              </button>
                                            </div>
                                          </div>
                                        </div>
                                        <div #collapse2="ngbCollapse" [(ngbCollapse)]="isCollapsed2">
                                          <div>
                                            <div class="row" style="align-items: center;justify-content: space-between;">
                                              <ul class="list-group list-group-horizontal list-group-flush">
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(2)">
                                                    <i class="fa fa-external-link"></i>
                                                    Copiar tabla
                                                  </button>
                                                </li>
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(2)">
                                                    <i class="fa fa-external-link"></i>
                                                    Exportar tabla a Excel
                                                  </button>
                                                </li>
                                              </ul>
                                            </div>
                                            <ngx-datatable #myTable2
                                            class="bootstrap table table-striped"
                                            id="datatablele"
                                              [columns]="columns2"
                                              [rows]="rows2"
                                              [columnMode]="ColumnMode.force"
                                              [headerHeight]="$any('auto')"
                                              [rowHeight]="$any('auto')"
                                              [scrollbarH]="true"
                                              [summaryRow]="enableSummary"
                                              [summaryPosition]="summaryPosition"
                                              [summaryHeight]="35"
                                              [selected]="selected"
                                              [selectionType]="SelectionType.single"
                                              (select)='open($event)'
                                              >
                                              <ngx-datatable-column [headerClass]="column.headerClass" [cellClass]="column.cellClass" [summaryFunc]="column.prop == 'PeriodoTXT' ? summaryNull:summaryForAmount" [flexGrow]="1" [minWidth]="90" [width]="column.width" *ngFor="let column of columns2; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                                                <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                                  let-row="row">
                                                  <!-- <span>{{value}}</span> -->
                                                  <span *ngIf="column.prop == 'PeriodoTXT' || column.prop == 'Total'">{{value}}</span>
                                                    <span *ngIf="value > 0 && column.prop !== 'PeriodoTXT' && column.prop !== 'Total'" [title]="value">
                                                      <a href="javascript:;" (click)="open($event, column.prop,'PAGADO','',content)" style="color: #4B9FDE;">{{value }}</a>
                                                    </span>
                                                    <span *ngIf="value == 0 && column.prop !== 'PeriodoTXT'">{{value }}</span>
                                                  <!-- <span *ngIf="column.prop !== 'PeriodoTXT'">{{value  | currency }}</span> -->
                                                </ng-template>
                                              </ngx-datatable-column>
                                            </ngx-datatable>
                                          </div>
                                        </div>
                                      </div>

                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card-footer">
                            <h6 class="card-title" style="bottom:13px;">Procesado el  {{procesado}}</h6>
                          </div>
                      </div>
                      </ng-template>
                </li>
                <li [ngbNavItem]="2">
                    <a ngbNavLink>PLANILLA MENSUAL</a>
                      <ng-template ngbNavContent>
                        
                        <div class="card " *ngIf="action">
                          <div class="card-header">
                            <h5 class="card-title" style="bottom:13px;">PAGOS DE PLANILLA {{message}}</h5>
                            <!-- <p>{{message}}</p> -->
                            
                          </div>
                          <div class="card-content collapse show">
                            <div class="card-body">
                              <div class="col-md-12 div_panel_cabecera">
                                <div class="col-md-3 col-sm-6 col-xs-12" id="div_mostrar_ptable_i">
                                    <div class="info-box">
                                        <span style="background:#3c8dbc !important; color:#fff !important;" class="info-box-icon">
                                            <i class="fa fa-street-view" aria-hidden="true"></i>
                                        </span>		
                                        <div class="info-box-content">
                                            <span style="font-family:arial; font-size:15px; " class="info-box-text">TOTAL PLANILLA {{periodo}}</span>
                                            <span  class="info-box-number" *ngIf="totalPlanilla">{{totalPlanilla | currency }}</span>
                                            <span  class="info-box-number" *ngIf="!totalPlanilla">Aún no cierran planilla</span>
                                            <!-- <label style="position:relative; top:13px; font-size:12px;" class="label label-pill label-success">Tiempo programado / 12 horas x dia
                                            </label> -->
                                        </div>
                                    </div>
                                    
                                </div>
                                <div class="col-md-3 col-sm-6 col-xs-12" id="div_mostrar_ptable_a">
                                    <div class="info-box">
                                        <span style="background: #f56954 !important; color:#fff !important;" class="info-box-icon">			
                                            <i class="fa fa-users" aria-hidden="true"></i>		</span>		
                                            <div class="info-box-content">			
                                              <span style="font-family:arial; font-size:15px; " class="info-box-text">TOTAL EMPLEADOS {{periodo}}</span>			
                                              <span class="info-box-number" *ngIf="totalEmpleados">{{totalEmpleados}}</span>
                                              <span  class="info-box-number" *ngIf="!totalEmpleados">Aún no cierran planilla</span>	
                                                <!-- <label style="position:relative; top:13px; font-size:12px;" class="label label-pill label-success"> {{ (efectivas/transacciones) * 100 | number: '1.2-2' }} %
                                                </label>		 -->
                                            </div>
                                        </div>
                                        
                                </div>
                              </div>
                              <div class="table table-striped table-bordered selection-deletion-row">
                                <div class="box box-solid">
                                  <div id="accordion2">
                                    <div class="row">
                                      <div class="card col-md-5">
                                        <div class="card-header-info" >
                                          <div class="box-header">
                                            <div class="toggle-table">
                                              <div class="callout callout-info">
                                                <h3 class="box-title">PLANILLA TOTAL EN SOLES</h3>
                                              </div>
                                              <button type="button" class="btn btn-outline-primary" (click)="collapse3.toggle()" [attr.aria-expanded]="!isCollapsed3"
                                              aria-controls="collapseExample">
                                              <i class="fa fa-minus" *ngIf="!isCollapsed3"> </i>
                                              <i class="fa fa-plus" *ngIf="isCollapsed3"> </i> 
                                              </button>
                                            </div>
                                          </div>
                                        </div>
                                        <div #collapse3="ngbCollapse" [(ngbCollapse)]="isCollapsed3">
                                            <div class="row" style="align-items: center;justify-content: space-between;">
                                              <ul class="list-group list-group-horizontal list-group-flush">
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(3)">
                                                    <i class="fa fa-external-link"></i>
                                                    Copiar tabla
                                                  </button>
                                                </li>
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(3)">
                                                    <i class="fa fa-external-link"></i>
                                                    Exportar tabla a Excel
                                                  </button>
                                                </li>
                                              </ul>
                                              <div class="mr-4">
                                                <select class="form-control form-select" style="width: auto!important;" (change)="tipoChangePer($event.target.value)" [(ngModel)]="selectedOptionPeriodo">
                                                  <option  *ngFor="let periodo of periodos"
                                                      [value]="periodo.value"
                                                  >
                                                      {{ periodo.value }}
                                                  </option>
                                                </select>
                                              </div>
                                              
                                            </div>
                                            <ngx-datatable #myTable3
                                            class="bootstrap table table-striped"
                                            id="datatablele"
                                              [columns]="columns3"
                                              [rows]="rows3filtered"
                                              [columnMode]="ColumnMode.force"
                                              [headerHeight]="$any('auto')"
                                              [rowHeight]="$any('auto')"
                                              [scrollbarH]="true"
                                              [summaryRow]="enableSummary"
                                              [summaryPosition]="summaryPosition"
                                              [summaryHeight]="35"
                                              [selected]="selected"
                                              [selectionType]="SelectionType.single"
                                              (select)='open($event)'
                                              >
                                              <ngx-datatable-column  [sortable]="false" [headerClass]="column.headerClass" [cellClass]="column.cellClass" [summaryFunc]="column.prop == 'Descripcion' || column.prop == 'PorcPend' ? summaryNull1:summaryForAmount" [flexGrow]="1" [minWidth]="90" [width]="column.width" *ngFor="let column of columns3; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                                                <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                                  let-row="row">
                                                  <!-- <span *ngIf="column.prop == 'PeriodoTXT' || column.prop == 'Total'">{{value}}</span>
                                                  <span *ngIf="value > 0 && column.prop !== 'PeriodoTXT' && column.prop !== 'Total'" [title]="value">
                                                    <a href="javascript:;" (click)="open($event, column.prop,'PAGADO','',content)" style="color: #4B9FDE;">{{value }}</a>
                                                  </span>
                                                  <span *ngIf="value == 0 && column.prop !== 'PeriodoTXT'">{{value }}</span> -->

                                                  <span *ngIf="column.prop == 'Descripcion'">{{value}}</span>
                                                  <span *ngIf="value > 0 && column.prop !== 'Descripcion' && column.prop !== 'PorcPend' && column.prop !== 'Total'">
                                                    <a href="javascript:;" (click)="open($event, '',column.prop,'',content)" style="color: #4B9FDE;"> {{value | currency }}</a>
                                                  </span>
                                                  <span *ngIf="value == 0 && column.prop !== 'Descripcion' && column.prop !== 'PorcPend' && column.prop !== 'Total'">{{value | currency }}</span>
                                                  <span *ngIf="column.prop == 'Total'">{{value | currency }}</span>
                                                  <span *ngIf="column.prop == 'PorcPend'">{{value | number: '1.2-2'}} %</span>
                                                </ng-template>
                                              </ngx-datatable-column>
                                            </ngx-datatable>
                                            <p id="p_div_tabla_05">* Colaboradores Activos en el periodo {{selectedOptionPeriodo}}</p>
                                        </div>
                                      </div>
                                      <div class="card col-md-4">
                                        <div class="card-header-info" >
                                          <div class="box-header">
                                            <div class="toggle-table">
                                              <div class="callout callout-info">
                                                <h3 class="box-title">PLANILLA TOTAL EN NRO. DE COLABORADORES</h3>
                                              </div>
                                              <button type="button" class="btn btn-outline-primary" (click)="collapse4.toggle()" [attr.aria-expanded]="!isCollapsed4"
                                              aria-controls="collapseExample">
                                              <i class="fa fa-minus" *ngIf="!isCollapsed4"> </i>
                                              <i class="fa fa-plus" *ngIf="isCollapsed4"> </i> 
                                              </button>
                                            </div>
                                          </div>
                                        </div>
                                        <div #collapse4="ngbCollapse" [(ngbCollapse)]="isCollapsed4">
                                            <div class="row" style="align-items: center;justify-content: space-between;">
                                              <ul class="list-group list-group-horizontal list-group-flush">
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(4)">
                                                    <i class="fa fa-external-link"></i>
                                                    Copiar tabla
                                                  </button>
                                                </li>
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(4)">
                                                    <i class="fa fa-external-link"></i>
                                                    Exportar tabla a Excel
                                                  </button>
                                                </li>
                                              </ul>
                                              <div class="mr-4">
                                                <select class="form-control form-select" style="width: auto!important;" (change)="tipoChangePer($event.target.value)" [(ngModel)]="selectedOptionPeriodo">
                                                  <option  *ngFor="let periodo of periodos"
                                                      [value]="periodo.value"
                                                  >
                                                      {{ periodo.value }}
                                                  </option>
                                                </select>
                                              </div>
                                            </div>
                                            <ngx-datatable #myTable4
                                            class="bootstrap table table-striped"
                                            id="datatablele"
                                              [columns]="columns4"
                                              [rows]="rows4filtered"
                                              [columnMode]="ColumnMode.force"
                                              [headerHeight]="$any('auto')"
                                              [rowHeight]="$any('auto')"
                                              [scrollbarH]="true"
                                              [summaryRow]="enableSummary"
                                              [summaryPosition]="summaryPosition"
                                              [summaryHeight]="35"
                                              [selected]="selected"
                                              [selectionType]="SelectionType.single"
                                              (select)='open($event)'
                                              >
                                              <ngx-datatable-column [sortable]="false" [headerClass]="column.headerClass" [cellClass]="column.cellClass" [summaryFunc]="column.prop == 'Descripcion' || column.prop == 'PorcPend' ? summaryNull1:summaryForAmount" [flexGrow]="1" [minWidth]="90" [width]="column.width" *ngFor="let column of columns4; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                                                <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                                  let-row="row">
                                                  <span *ngIf="column.prop == 'Descripcion'">{{value}}</span>
                                                  <span *ngIf="value > 0 && column.prop !== 'Descripcion' && column.prop !== 'PorcPend' && column.prop !== 'Total'">
                                                    <a href="javascript:;" (click)="open($event, '',column.prop,'',content)" style="color: #4B9FDE;"> {{value }}</a>
                                                  </span>
                                                  <span *ngIf="value == 0 && column.prop !== 'Descripcion' && column.prop !== 'PorcPend' && column.prop !== 'Total'">{{value }}</span>


                                                  <!-- <span *ngIf="column.prop !== 'PorcPend'">{{value}}</span>
                                                  
                                                  <span *ngIf="column.prop == 'PorcPend'">{{value | number: '1.2-2'}} %</span> -->
                                                </ng-template>
                                              </ngx-datatable-column>
                                            </ngx-datatable>
                                            <p id="p_div_tabla_05">* Colaboradores Activos en el periodo {{selectedOptionPeriodo}}</p>
                                        </div>
                                      </div>
                                      <div class="card col-md-3">
                                        <div class="card-body">
                                          <div class="d-block" *ngFor="let bar of barData; let i = index;">
                                            <span style="display:flex; justify-content: space-between;"><b>{{bar.tipo}}</b>{{bar.value}} - {{bar.percented}}%</span>
                                              <ngb-progressbar
                                                  [type]="color[i]"
                                                  [value]="bar.percented"
                                                  [striped]="true"
                                                  [animated]="true">
                                              </ngb-progressbar>
                                              <p></p>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="row">
                                      <div class="card col-md-6">
                                        <div class="card-header-info" >
                                          <div class="box-header">
                                            <div class="toggle-table">
                                              <div class="callout callout-info">
                                                <h3 class="box-title">PLANILLA TOTAL DE ACTIVOS EN SOLES</h3>
                                              </div>
                                              <button type="button" class="btn btn-outline-primary" (click)="collapse5.toggle()" [attr.aria-expanded]="!isCollapsed5"
                                              aria-controls="collapseExample">
                                              <i class="fa fa-minus" *ngIf="!isCollapsed5"> </i>
                                              <i class="fa fa-plus" *ngIf="isCollapsed5"> </i> 
                                              </button>
                                            </div>
                                          </div>
                                        </div>
                                        <div #collapse5="ngbCollapse" [(ngbCollapse)]="isCollapsed5">
                                            <div class="row" style="align-items: center;justify-content: space-between;">
                                              <ul class="list-group list-group-horizontal list-group-flush">
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(5)">
                                                    <i class="fa fa-external-link"></i>
                                                    Copiar tabla
                                                  </button>
                                                </li>
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(5)">
                                                    <i class="fa fa-external-link"></i>
                                                    Exportar tabla a Excel
                                                  </button>
                                                </li>
                                              </ul>
                                              <div class="mr-4">
                                                <select class="form-control form-select" style="width: auto!important;" (change)="tipoChangePer($event.target.value)" [(ngModel)]="selectedOptionPeriodo">
                                                  <option  *ngFor="let periodo of periodos"
                                                      [value]="periodo.value"
                                                  >
                                                      {{ periodo.value }}
                                                  </option>
                                                </select>
                                              </div>
                                            </div>
                                            <ngx-datatable #myTable5
                                            class="bootstrap table table-striped"
                                            id="datatablele"
                                              [columns]="columns5"
                                              [rows]="rows5filtered"
                                              [columnMode]="ColumnMode.force"
                                              [headerHeight]="$any('auto')"
                                              [rowHeight]="$any('auto')"
                                              [scrollbarH]="true"
                                              [summaryRow]="enableSummary"
                                              [summaryPosition]="summaryPosition"
                                              [summaryHeight]="35"
                                              >
                                              <ngx-datatable-column [sortable]="false" [headerClass]="column.headerClass" [cellClass]="column.cellClass" [summaryFunc]="column.prop == 'Descripcion' || column.prop == 'PorcPend' ? summaryNull1:summaryForAmount" [flexGrow]="1" [minWidth]="90" [width]="column.width" *ngFor="let column of columns5; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                                                <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                                  let-row="row">
                                                  <span *ngIf="column.prop == 'Descripcion'">{{value }}</span>
                                                  <span *ngIf="column.prop !== 'Descripcion' && column.prop !== 'PorcPend'">{{value | currency }}</span>
                                                  <span *ngIf="column.prop == 'PorcPend'">{{value | number: '1.2-2'}} %</span>
                                                </ng-template>
                                              </ngx-datatable-column>
                                            </ngx-datatable>
                                            <p id="p_div_tabla_05">* Colaboradores Activos en el periodo {{selectedOptionPeriodo}}</p>
                                        </div>
                                      </div>
                                      <div class="card col-md-6">
                                        <div class="card-header-info" >
                                          <div class="box-header">
                                            <div class="toggle-table">
                                              <div class="callout callout-info">
                                                <h3 class="box-title">PLANILLA TOTAL DE ACTIVOS EN NRO. DE COLABORADORES</h3>
                                              </div>
                                              <button type="button" class="btn btn-outline-primary" (click)="collapse6.toggle()" [attr.aria-expanded]="!isCollapsed6"
                                              aria-controls="collapseExample">
                                              <i class="fa fa-minus" *ngIf="!isCollapsed6"> </i>
                                              <i class="fa fa-plus" *ngIf="isCollapsed6"> </i> 
                                              </button>
                                            </div>
                                          </div>
                                        </div>
                                        <div #collapse6="ngbCollapse" [(ngbCollapse)]="isCollapsed6">
                                            <div class="row" style="align-items: center;justify-content: space-between;">
                                              <ul class="list-group list-group-horizontal list-group-flush">
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(6)">
                                                    <i class="fa fa-external-link"></i>
                                                    Copiar tabla
                                                  </button>
                                                </li>
                                                <li class="list-group-item border-0 pl-0">
                                                  <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(6)">
                                                    <i class="fa fa-external-link"></i>
                                                    Exportar tabla a Excel
                                                  </button>
                                                </li>
                                              </ul>
                                              <div class="mr-4">
                                                <select class="form-control form-select" style="width: auto!important;" (change)="tipoChangePer($event.target.value)" [(ngModel)]="selectedOptionPeriodo">
                                                  <option  *ngFor="let periodo of periodos"
                                                      [value]="periodo.value"
                                                  >
                                                      {{ periodo.value }}
                                                  </option>
                                                </select>
                                              </div>
                                            </div>
                                            <ngx-datatable #myTable6
                                            class="bootstrap table table-striped"
                                            id="datatablele"
                                              [columns]="columns6"
                                              [rows]="rows6filtered"
                                              [columnMode]="ColumnMode.force"
                                              [headerHeight]="$any('auto')"
                                              [rowHeight]="$any('auto')"
                                              [scrollbarH]="true"
                                              [summaryRow]="enableSummary"
                                              [summaryPosition]="summaryPosition"
                                              [summaryHeight]="35"
                                              >
                                              <ngx-datatable-column [sortable]="false" [headerClass]="column.headerClass" [cellClass]="column.cellClass" [summaryFunc]="column.prop == 'Descripcion' || column.prop == 'PorcPend' ? summaryNull1:summaryForAmount" [flexGrow]="1" [minWidth]="90" [width]="column.width" *ngFor="let column of columns6; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                                                <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                                  let-row="row">
                                                  <span *ngIf="column.prop !== 'PorcPend'">{{value}}</span>
                                                  
                                                  <span *ngIf="column.prop == 'PorcPend'">{{value | number: '1.2-2'}} %</span>
                                                </ng-template>
                                              </ngx-datatable-column>
                                            </ngx-datatable>
                                            <p id="p_div_tabla_05">* Colaboradores Activos en el periodo {{selectedOptionPeriodo}}</p>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="card">
                                      <div class="card-header">
                                        <div class="row" style="align-items: center;justify-content: space-between;">
                                          <div class="">
                                              <p class="box-title">Resumen de Planilla Mensual en Soles x 100</p>
                                          </div>
                                          <ul class="list-group list-group-horizontal list-group-flush" style="flex-wrap: wrap;">
                                            
                                            <li class="list-group-item border-0 pl-0">
                                              <a  id="downloadlink" href="#" 
                                                class="btn btn-sm font-weight-bold btn-link" (click)="guardarImagen()" download>
                                                <i class="fa fa-external-link"></i>
                                                Guardar Imagen
                                              </a>
                                            </li>
                                          </ul>                                              
                                        </div>
                                      </div>
                                      <div class="card-body" >
                                          <div class="d-block chart-container" style="height: 500px;">
                                            <canvas #baseChart id="chart-1">
                                            </canvas>
                                          </div>
                                      </div>
                                    </div>
                                    <div class="card">
                                      <div class="card-header">
                                        <div class="row" style="align-items: center;justify-content: space-between;">
                                          <div class="">
                                              <p class="box-title">Resumen de Colaboradores por Planilla Mensual</p>
                                          </div>
                                          <ul class="list-group list-group-horizontal list-group-flush" style="flex-wrap: wrap;">
                                            
                                            <li class="list-group-item border-0 pl-0">
                                              <a  id="downloadlink1" href="#" 
                                                class="btn btn-sm font-weight-bold btn-link" (click)="guardarImagen1()" download>
                                                <i class="fa fa-external-link"></i>
                                                Guardar Imagen
                                              </a>
                                            </li>
                                          </ul>                                              
                                        </div>
                                      </div>
                                      <div class="card-body">
                                          <div class="d-block chart-container" style="height: 500px;">
                                            <canvas #baseChart id="chart-2" >
                                            </canvas>
                                          </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card-footer">
                            <h6 class="card-title" style="bottom:13px;">Procesado el  {{procesado}}</h6>
                          </div>
                      </div>
                      </ng-template>
                </li>
                <li [ngbNavItem]="3">
                    <a ngbNavLink>PENDIENTES DE PAGO A LA ACTUALIDAD</a>
                    <ng-template ngbNavContent>
                      <div class="card" *ngIf="action">
                        <div class="card-header">
                          <h4 class="card-title">PLANILLA PENDIENTE DE PAGO AL {{message}}</h4>
                          <!-- <p>{{message}}</p> -->
                        </div>
                        <div class="card-content collapse show">
                          <div class="card-body">
                            <div class="table table-striped table-bordered selection-deletion-row">
                              <div class="box box-solid">
                                <div id="accordion3">
                                  <div class="row">
                                    <div class="card col-md-6">
                                      <div class="card-header-info" >
                                        <div class="box-header">
                                          <div class="toggle-table">
                                            <div class="callout callout-info">
                                              <h3 class="box-title">PAGOS PENDIENTES EN PERIODO SELECCIONADO EN SOLES</h3>
                                            </div>
                                            <button type="button" class="btn btn-outline-primary" (click)="collapse7.toggle()" [attr.aria-expanded]="!isCollapsed7"
                                            aria-controls="collapseExample">
                                            <i class="fa fa-minus" *ngIf="!isCollapsed7"> </i>
                                            <i class="fa fa-plus" *ngIf="isCollapsed7"> </i> 
                                            </button>
                                          </div>
                                        </div>
                                      </div>
                                      <div #collapse7="ngbCollapse" [(ngbCollapse)]="isCollapsed7">
                                          <div class="row" style="align-items: center;justify-content: space-between;">
                                            <ul class="list-group list-group-horizontal list-group-flush" style="flex-wrap: wrap;">
                                              <li class="list-group-item border-0 pl-0">
                                                <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(7)">
                                                  <i class="fa fa-external-link"></i>
                                                  Copiar tabla
                                                </button>
                                              </li>
                                              <li class="list-group-item border-0 pl-0">
                                                <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(7)">
                                                  <i class="fa fa-external-link"></i>
                                                  Exportar tabla a Excel
                                                </button>
                                              </li>
                                            </ul>
                                          </div>
                                          <ngx-datatable #myTable7
                                            class="bootstrap table table-striped"
                                            id="datatablele"
                                              [columns]="columns7"
                                              [rows]="rows7"
                                              [columnMode]="ColumnMode.flex"
                                              [headerHeight]="50"
                                              [rowHeight]="$any('auto')"
                                              [scrollbarH]="true"
                                              (page)="setPage($event)"
                                              [summaryRow]="enableSummary"
                                            [summaryPosition]="summaryPosition"
                                            [summaryHeight]="35"
                                            [selected]="selected"
                                              [selectionType]="SelectionType.single"
                                              (select)='open($event)'
                                              >
                                              <ngx-datatable-column  [headerClass]="column.headerClass" [cellClass]="column.cellClass" [summaryFunc]="column.prop == 'PeriodoTXT' ? summaryNull:summaryForAmount"
                                              [flexGrow]="1" [minWidth]="90" [pipe]="column.pipe" *ngFor="let column of columns7; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                                                <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                                  let-row="row">
                                                  <div>
                                                    <span *ngIf="column.prop == 'PeriodoTXT'">{{value}}</span>
                                                    <span *ngIf="column.prop !== 'PeriodoTXT'">{{value  | currency }}</span>
                                                  </div>
                                                </ng-template>
                                              </ngx-datatable-column>
                                          </ngx-datatable>
                                        
                                      </div>
                                    </div>
                                    <div class="card col-md-6">
                                      <div class="card-header-info" >
                                        <div class="box-header">
                                          <div class="toggle-table">
                                            <div class="callout callout-info">
                                              <h3 class="box-title">PAGOS PENDIENTES EN PERIODO SELECCIONADO EN NRO. DE COLABORADORES</h3>
                                            </div>
                                            <button type="button" class="btn btn-outline-primary" (click)="collapse8.toggle()" [attr.aria-expanded]="!isCollapsed8"
                                            aria-controls="collapseExample">
                                            <i class="fa fa-minus" *ngIf="!isCollapsed8"> </i>
                                            <i class="fa fa-plus" *ngIf="isCollapsed8"> </i> 
                                            </button>
                                          </div>
                                        </div>
                                      </div>
                                      <div #collapse8="ngbCollapse" [(ngbCollapse)]="isCollapsed8">
                                          <div class="row" style="align-items: center;justify-content: space-between;">
                                            <ul class="list-group list-group-horizontal list-group-flush" style="flex-wrap: wrap;">
                                              <li class="list-group-item border-0 pl-0">
                                                <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(8)">
                                                  <i class="fa fa-external-link"></i>
                                                  Copiar tabla
                                                </button>
                                              </li>
                                              <li class="list-group-item border-0 pl-0">
                                                <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(8)">
                                                  <i class="fa fa-external-link"></i>
                                                  Exportar tabla a Excel
                                                </button>
                                              </li>
                                            </ul>
                                          </div>
                                          <ngx-datatable #myTable8
                                            class="bootstrap table table-striped "
                                            id="datatablele"
                                              [columns]="columns8"
                                              [rows]="rows8"
                                              [columnMode]="ColumnMode.flex"
                                              [headerHeight]="50"
                                              [rowHeight]="$any('auto')"
                                              [scrollbarH]="true"
                                              (page)="setPage($event)"
                                              [summaryRow]="enableSummary"
                                              [summaryPosition]="summaryPosition"
                                              [summaryHeight]="35"
                                              [selected]="selected"
                                              [selectionType]="SelectionType.single"
                                              (select)='open($event)'
                                              >
                                              <ngx-datatable-column [headerClass]="column.headerClass" [cellClass]="column.cellClass"
                                              [flexGrow]="1" [minWidth]="90" [summaryFunc]="column.prop == 'PeriodoTXT' ? summaryNull:summaryForAmount"  *ngFor="let column of columns8; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                                                <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                                  let-row="row">
                                                  <span *ngIf="column.prop == 'PeriodoTXT' || column.prop == 'Total'">{{value}}</span>
                                                    <span *ngIf="value > 0 && column.prop !== 'PeriodoTXT' && column.prop !== 'Total'" [title]="value">
                                                      <a href="javascript:;" (click)="open($event, column.prop,'PENDIENTE','',content)" style="color: #4B9FDE;">{{value }}</a>
                                                    </span>
                                                    <span *ngIf="value == 0 && column.prop !== 'PeriodoTXT'">{{value }}</span>
                                                  
                                                  <!-- <span>{{value}}</span> -->
                                                </ng-template>
                                              </ngx-datatable-column>
                                          </ngx-datatable>
                                      </div>
                                    </div>
                                  </div>
                                </div>                       
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="card-footer">
                          <h6 class="card-title" style="bottom:13px;">Procesado el  {{procesado}}</h6>
                        </div>
                      </div>
                    </ng-template>
                </li>
                <li [ngbNavItem]="4">
                  <a ngbNavLink>FECHA DE PAGOS</a>
                  <ng-template ngbNavContent>
                    <div class="card" *ngIf="action">
                      <div class="card-header">
                        <h4 class="card-title">DEMORA EN PAGOS DE PLANILLA {{message}}</h4>
                        <!-- <p>{{message}}</p> -->
                      </div>
                      <div class="card-content collapse show">
                        <div class="card-body">
                          <div class="table table-striped table-bordered selection-deletion-row">
                            <div class="box box-solid">
                              <div id="accordion4">
                                <div class="card">
                                  <div class="card-header-info" >
                                    <div class="box-header">
                                      <div class="toggle-table">
                                        <div class="callout callout-info">
                                          <h3 class="box-title">RANGO DE FECHAS POR PAGOS (PLANILLA MENSUAL)</h3>
                                        </div>
                                        <button type="button" class="btn btn-outline-primary" (click)="collapse9.toggle()" [attr.aria-expanded]="!isCollapsed9"
                                        aria-controls="collapseExample">
                                        <i class="fa fa-minus" *ngIf="!isCollapsed9"> </i>
                                        <i class="fa fa-plus" *ngIf="isCollapsed9"> </i> 
                                        </button>
                                      </div>
                                    </div>
                                  </div>
                                  <div #collapse9="ngbCollapse" [(ngbCollapse)]="isCollapsed9">
                                      <div class="row" style="align-items: center;justify-content: space-between;">
                                        <ul class="list-group list-group-horizontal list-group-flush" style="flex-wrap: wrap;">
                                          <li class="list-group-item border-0 pl-0">
                                            <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(9)">
                                              <i class="fa fa-external-link"></i>
                                              Copiar tabla
                                            </button>
                                          </li>
                                          <li class="list-group-item border-0 pl-0">
                                            <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(9)">
                                              <i class="fa fa-external-link"></i>
                                              Exportar tabla a Excel
                                            </button>
                                          </li>
                                        </ul>
                                        <div style="display:flex;align-items: center; justify-content:flex-end">
                                          <select class="form-control form-select" style="width: auto!important;" (change)="tipoChange($event.target.value)" [(ngModel)]="selectedOptionTipo">
                                            <option value="EMPLEADOS">EMPLEADOS</option>
                                            <option value="FUNCIONARIOS">FUNCIONARIOS</option>
                                            <option value="OBREROS">OBREROS</option>
                                            <option value="PRACTICANTE">PRACTICANTE</option>
                                          </select>
                                          <div class="" style="display:flex;margin:15px;align-items: center;">
                                            <span>Buscar</span>&nbsp;&nbsp;
                                              <input type="text" style='padding:6px;width:100%;' placeholder="por cualquier campo" (keyup)='updateFilter($event, selectedOptionTipo)'>
                                          </div>
                                        </div> 
                                      </div>
                                      <ngx-datatable #myTable9
                                        class="bootstrap table table-striped "
                                        id="datatablele"
                                          [columns]="columns9"
                                          [rows]="rows9filtered"
                                          [columnMode]="ColumnMode.flex"
                                          [headerHeight]="50"
                                          [rowHeight]="$any('auto')"
                                          [scrollbarH]="true"
                                          (page)="setPage($event)"
                                          [rowClass] = "getRowClass1"

                                          >
                                          <ngx-datatable-column [headerClass]="column.headerClass" [cellClass]="column.cellClass" 
                                          [flexGrow]="1" [minWidth]="90" [pipe]="column.pipe" *ngFor="let column of columns9; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                                            <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                                              let-row="row">
                                              <div>
                                                <span *ngIf="column.prop !== 'PagadoSoles' && column.prop !== 'PorcPagado'">{{value}}</span>
                                                <span *ngIf="column.prop == 'PagadoSoles'">{{value | currency }}</span>
                                                <span *ngIf="column.prop == 'PorcPagado'">{{value | number: '1.2-2'}} %</span>
                                                <!-- <span *ngIf="column.prop !== 'PeriodoTXT' && column.prop !== 'Descripcion' &&  column.prop == 'FechaInicio' && column.prop == 'FechaFin'">{{value  | currency }}</span> -->
                                              </div>
                                            </ng-template>
                                          </ngx-datatable-column>
                                      </ngx-datatable>
                                      <div class="ml-3">
                                        <p>
                                          <b>* PAGADO NRO: </b>Cantidad de colaboradores pagados bajo el concepto de Planilla Mensual.<br>
                                          <b>* PAGADO SOLES: </b>Sumatoria de Planilla Mensual Pagada.<br>
                                          <b>* FECHA INICIO: </b>Fecha de pago del primer colaborador de la Planilla Mensual del periodo correspondiente.<br>
                                          <b>* FECHA FINAL: </b>Fecha de pago del último colaborador de la Planilla Mensual del periodo correspondiente.<br>
                                          <b>* DIAS: </b>Intervalo en dias desde la primera hasta la última fecha de pago de planilla mensual del periodo correspondiente.<br>
                                          <b>* %PAGADO: </b>Porcentaje de avance de pago de planilla mensual del periodo correspondiente.
                                        </p>
                                      </div>                                 
                                  </div>
                                </div>
                              </div>                       
                            </div>
                          </div>
                          
                        </div>
                      </div>
                      <div class="card-footer">
                        <h6 class="card-title" style="bottom:13px;">Procesado el  {{procesado}}</h6>
                      </div>
                    </div>
                  </ng-template>
                </li>
                <!-- tabla modal -->
                <ng-template #content let-modal>
                  <div class="modal-header">
                    <p class="modal-title" id="modal-basic-title">Periodo: {{ periodoSeleccionado }}<b>{{ TipoPlanilla !== '' ? 'Tipo de Planilla:' : 'Tipo de Pago:'}}  {{tipoPago ? tipoDePago : TipoPlanilla}}  </b>( {{EstadoDeposito}} )</p>
                    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="row" style='display:flex; justify-content:space-between;'>
                      <div class="col-md-2" style='margin-left:15px;'>
                          <select class="form-control form-select" (change)="onLimitChange($event.target.value)">
                              <option
                                  *ngFor="let option of pageLimitOptions"
                                  [value]="option.value"
                              >
                                  {{ option.value }} Registros
                              </option>
                          </select>
                      </div>
                      <div class="col-md-2" style="display:flex;margin-right:15px;align-items: center;">
                          <button class="btn btn-sm font-weight-bold btn-link" (click)="copyTableToClipboard(10)">
                              <i class="fa fa-external-link"></i>
                              Copiar tabla
                          </button>
                      </div>
                      <div class="col-md-2" style="display:flex;margin-right:15px;align-items: center;">
                          <button class="btn btn-sm font-weight-bold btn-link" (click)="exportToExcel(10)">
                              <i class="fa fa-external-link"></i>
                              Exportar tabla a Excel
                          </button>
                      </div>
                      <div class="col-md-2" style="display:flex;margin-right:15px;align-items: center;">
                          <span>Buscar</span>&nbsp;&nbsp;
                          <input type="text" style='padding:6px;width:100%;' placeholder="por cualquier campo" (keyup)='updateFilter($event, 17)'>
                      </div>
                  </div>
                  <div class="modal-body">
                    <ngx-datatable #myTable11
                    class="bootstrap table table-striped"
                    id="datatablele"
                    [columns]="columnsModal"
                    [loadingIndicator]="loading"
                    [rows]="rowsModal"
                    [columnMode]="ColumnMode.flex"
                    [headerHeight]="50"
                    [footerHeight]="50"
                    [rowHeight]="$any('auto')"
                    [scrollbarH]="true"
                    [limit]="page.size"
                    >
                      <ngx-datatable-column [flexGrow]="1" [minWidth]="90" [headerClass]="column.headerClass" [cellClass]="column.cellClass" *ngFor="let column of columnsModal; let i = index;" name="{{column.name}}" prop="{{column.prop}}">
                        <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value"
                          let-row="row">
                          <div>
                            <span  [title]="value">{{value}}</span>
                          </div>
                        </ng-template>
                      </ngx-datatable-column>
                    </ngx-datatable>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Cerrar</button>
                  </div>
                </ng-template>
              </ul>
                <div [ngbNavOutlet]="nav" class="mt-2"></div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
  
  <!-- ////////////////////////////////////////////////////////////////////////////-->
  
